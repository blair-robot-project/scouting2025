---
title: "449 Scouting 2025"
format: html
editor: visual
params:
    red1: 449
    red2: 451
    red3: 456
    blue1: 487
    blue2: 563
    blue3: 452
---

```{r setup, message=FALSE, warning=FALSE}
rm(list = setdiff(ls(),"params"))

library(tidyverse)

blair_red <- "#a7000a"

red_alliance <- c(params$red1, params$red2, params$red3)
blue_alliance <- c(params$blue1, params$blue2, params$blue3)

raw <- read_csv("made_up_data.csv")
```

```{r dplyr}
 
data <- raw %>%
  mutate(total_coral_score = (coral_L1_num*2) + (coral_L2_num*3) + (coral_L3_num*4) + (coral_L4_num*5))
  
data <- data %>%
  group_by(team) %>%
  summarize(
    matches = n(),
    
    close_pct = sum(start == "Close" , na.rm = TRUE) / matches,
    middle_pct = sum(start == "Middle", na.rm = TRUE) / matches,
    far_pct = sum(start == "Far" , na.rm = TRUE) / matches,
    
    show_pct = sum(show == "TRUE", na.rm = TRUE) / matches,
    move_pct = sum(move == "TRUE", na.rm = TRUE) / matches,
    

    l1 = mean(coral_L1_num),
    l2 = mean(coral_L2_num),
    l3 = mean(coral_L3_num),
    l4 = mean(coral_L4_num),
    
    total_mean = mean(total_coral_score),
    
    avg_score = sum(l1coralscore,l2coralscore,l3coralscore,l4coralscore)/matches,
    
    
    auto_coral_L1_num = sum(auto_coral_L1_num)/n(),
    auto_coral_L2_num = sum(auto_coral_L2_num)/n(),
    auto_coral_L3_num = sum(auto_coral_L3_num)/n(),
    auto_coral_L4_num = sum(auto_coral_L4_num)/n(),

    auto_coral_score = sum(auto_coral_L1_num*3+auto_coral_L2_num*4+
                           auto_coral_L3_num*6+auto_coral_L4_num*7)/n(),
    
    robot_net_total_num = sum(robot_net_score+robot_net_miss)/n(),
    robot_net_average_num = sum(
      ifelse(robot_net_score+robot_net_miss!=0, 
             robot_net_score/(robot_net_score+robot_net_miss),
             0))/n(),
    robot_net_score = sum(robot_net_score)/n(),
    proc_score = sum(proc_score)/n()
  )



  



data <- data %>%
  filter(team %in% c(red_alliance, blue_alliance))

```

```{r}
boxplot <- raw %>%
  mutate(total_coral_score = 
           (coral_L1_num*2) + (coral_L2_num*3) + 
           (coral_L3_num*4) + (coral_L4_num*5),
         total_algea_score = 
           (robot_net_score*4) + (proc_score*2.5),
         total_endgame_score = 
           ifelse(endgame =="D", 12, ifelse(endgame=="S",6,ifelse(endgame=="P", 2, 0))
           )




  

 ggplot(graph,aes(x = total, y = team))+
 geom_boxplot(position = "dodge2", geom = "boxplot") +
   stat_boxplot(geom = "errorbar")+
   geom_point(aes(x =total_mean, y = team ), color = 'orange', size = 2)
  
    
       labs(title = "Level Summary",
          x = "Team", y = "Coral score")+
    theme_bw()
```

```{r}
 bar <- raw %>%
   
  group_by(team) %>%
  summarize(
    matches = n(),
  
    l1 = mean(coral_L1_num),
    l2 = mean(coral_L2_num),
    l3 = mean(coral_L3_num),
    l4 = mean(coral_L4_num)
  
  )%>%
    pivot_longer(cols = c(l4, l3, l2,l1), 
                 names_to = "level", 
                 values_to = "coral_num")
 
bar$level_score <- case_when(
  bar$level == "l1" ~ bar$coral_num*2, 
  bar$level == "l2" ~ bar$coral_num*3, 
  bar$level == "l3" ~ bar$coral_num*4, 
  bar$level == "l4" ~ bar$coral_num*5, 
)

 
bar <- bar%>%
  filter(team %in% c(red_alliance, blue_alliance)) %>%
  mutate(team = factor(team, c(red_alliance,blue_alliance) ))

  ggplot(bar, aes(x = `team`, y = level_score, fill = level)) + 
     geom_bar(position = "stack", stat = "identity") + 
     labs(title = "Level Summary", 
          x = "Team", y = "Coral score", fill = "Level") +
    scale_fill_manual(values=c("lightskyblue","royalblue1","royalblue3","navy"))+
   

     theme_bw()



```

```{r}
ggplot(graph)

```
